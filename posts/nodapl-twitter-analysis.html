<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2016-11-06">

<title>Ryan M Horne - #NoDAPL Twitter Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Ryan M Horne</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../posts.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../digital-portfolio.html"> 
<span class="menu-text">Digital Portfolio</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/rmhorne"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://orcid.org/0000-0002-5009-3116"> 
<span class="menu-text">https://orcid.org/0000-0002-5009-3116</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://hcommons.social/web/@rmhorne"> <i class="bi bi-mastodon" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/RyanMHorne"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">#NoDAPL Twitter Analysis</h1>
  <div class="quarto-categories">
    <div class="quarto-category">maps</div>
    <div class="quarto-category">social-networks</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 6, 2016</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><strong>Introduction:</strong></p>
<p>[caption id=“attachment_512” align=“alignright” width=“327”]<img src="https://ryanmatthewhorne.files.wordpress.com/2016/11/dapl_routes_map_large.png?w=2048" class="img-fluid" alt="dapl_routes_map_large"> Map By Carl Sack[/caption]</p>
<p>The approximately 1,172 mile Dakota Access Pipeline<a href="#sdfootnote1sym">1</a> has been highly controversial since its public unveiling in 2014.<a href="#sdfootnote2sym">2</a> The Standing Rock Sioux and allied organizations took ultimately unsuccessful legal action to stop construction of the project, <a href="#sdfootnote3sym">3</a> while youth from the reservation began a social media campaign which gradually morphed into a larger movement with dozens of associated hashtags.<a href="#sdfootnote4sym">4</a> I performed network analysis on #NODAPL, the most prominent of these hashtags on Twitter, between October 22 - 30, 2016. This revealed some interesting trends in the data, including the key role of alternative media, celebrities, and seemingly random twitter users holding the network together. Another surprising finding was the relatively minor role that republican candidate Donald Trump’s twitter account plays in the #NODAPL conversation, especially compared to the accounts of Barack Obama, Hilary Clinton, Bernie Sanders, and Dr.&nbsp;Jill Stein.</p>
<p>[caption id=“attachment_560” align=“alignnone” width=“1024”]<img src="initatives/my_research/academic_site/site/rmhorne/posts/images/funtitled.png" class="img-fluid" alt="funtitled"> My Visualization of the #NODAPL network[/caption]</p>
<p><strong>Preliminary Network Analysis:</strong></p>
<p>Due to restrictions from the Twitter API and crashes / limitations from the software (see below), I do not have complete access to all Tweet traffic involving #NODAPL.<a href="#sdfootnote5sym">5</a> I used the Twitter Archiving Google Sheet (TAGS) 6.1<a href="#sdfootnote6sym">6</a> to capture tweets that featured #NODAPL somewhere the tweet text. The resulting sheets were then imported into a database, then exported into an edges table for use in Gephi. For technical details, see the “<a href="#Procedure">Detailed Procedure</a>” section below.</p>
<p>Basic to any network analysis is the concept of nodes and edges. Nodes can represent people, places, things, ideas, etc – they are entities on the graph. In this case, nodes are twitter users and hashtags. Edges associate nodes in some manner; they can represent friendship, biological relationships, enmity, or anything else that links two nodes. For my analysis, edges are anytime a user includes a user name or hashtag in a tweet. For example, one of the most prominent users in this study, <span class="citation" data-cites="RUTHHHOPKINS">@RUTHHHOPKINS</span> is represented as a node, with an edge created to the node #NODAPL every time she uses the hashtag in a tweet, like the example below:</p>
<p>https://twitter.com/RuthHHopkins/status/794979004352700418</p>
<p># NODAPL itself was excluded as a node in this analysis, as every tweet and user would be directly connected to it. This network features 133,702 nodes linked by 630,393 edges.<a href="#sdfootnote7sym">7</a> I used Gephi to identify communities of nodes that&nbsp;are strongly linked together, which are represented by different colors in the network visualization.<a href="#sdfootnote8sym">8</a> In addition, I ran some basic network statistics, including measuring the degree of nodes (the number of edges between two individuals, hashtags, or individuals and hashtags) on the graph. In these measurements <em>out-degree</em> indicates that a node initiates a link to another node in the graph, which in this case means another user name or hashtag was mentioned in a text by the node in question. <em>in-degree</em> measures incoming edges, which indicates that a particular node is the subject of a twitter conversation.</p>
<p>I first looked at the in-degree measurement. #STANDINGROCK was by far the node with the highest in-degree, indicating its popularity as a potential alternative hashtag to #NODAPL. <span class="citation" data-cites="POTUS">@POTUS</span>, the official twitter account of the President of the United States, was in second place, followed by #WATERISLIFE, <span class="citation" data-cites="HILLARYCLINTON">@HILLARYCLINTON</span>, <span class="citation" data-cites="OFFICIALJADEN">@OFFICIALJADEN</span>, <span class="citation" data-cites="UR">@UR</span>_NINJA, <span class="citation" data-cites="SHAILENEWOODLEY">@SHAILENEWOODLEY</span>, <span class="citation" data-cites="MARKRUFFALO">@MARKRUFFALO</span>, and <span class="citation" data-cites="RUTHHHOPKINS">@RUTHHHOPKINS</span>. In this list, only two nodes are not politicians, hashtags, or celebrities. <span class="citation" data-cites="UR">@UR</span>_Ninja is the official twitter account of Unicorn Riot<a href="#sdfootnote9sym">9</a>, a 501(c)3 nonprofit organization based in Minneapolis, Minnesota<a href="#sdfootnote10sym">10</a> which has done extensive reporting on the Dakota Access Pipeline protests. <span class="citation" data-cites="RUTHHHOPKINS">@RUTHHHOPKINS</span> is the twitter account of Ruth Hopkins, a Dakota/Lakota Sioux writer, journalist, and blogger. The high degree count on these nodes indicates that they may function as an information service, where their reporting on the situation is retweeted and mentioned by many other nodes in the network.</p>
<p>This measurement also revealed a marked difference between the in-degree and out-degree of nodes. The top 34 nodes by number of degrees are so dominated by in-degree connections that no node has an out-degree that contains more than 3.17% of its total edges. This reveals that such&nbsp;nodes are being “talked at”: they are mentioned in tweets, retweeted in large numbers, but by and large feature extremely limited further engagement with other Twitter users.</p>
<p>A particular user group is indicative of this trend. Few politicians have used Twitter to actively engage with activists or to contribute to the dialogue surrounding the #NoDAPL movement. In some cases this is not surprising; the official twitter account of the President of the United States can scarcely be expected to contribute extensively to dialogue on twitter. Despite being the seventh&nbsp;highest degree node and an occupation of her Brooklyn campaign headquarters on October 27, 2016<a href="#sdfootnote11sym">11</a> <span class="citation" data-cites="HILLARYCLINTON">@HILLARYCLINTON</span>, the official account of Hillary Clinton, has likewise not responded to #NoDAPL conversations on twitter. The official account of Bernie Sanders, <span class="citation" data-cites="SENSANDERS">@SENSANDERS</span>, has also not extensively engaged with #NODAPL. However, on October 31, 2016, which is outside of the bounds of my data set, his account did issue a series of tweets in support of the # NODAPL movement.<a href="#sdfootnote12sym">12</a></p>
<p>https://twitter.com/SenSanders/status/793196920613240840</p>
<p>Another account of a politician, Dr.&nbsp;Jill Stein (<span class="citation" data-cites="DRJILLSTEIN">@DRJILLSTEIN</span>), is twelfth&nbsp;on in-degree, but only has five outwardly directed edges. Despite active involvement at the protests leading to charges of criminal trespass and criminal mischief,<a href="#sdfootnote13sym">13</a> Dr.&nbsp;Stein’s twitter account has barely engaged with other users, with the only mentions in this data set originating from a retweet that mentioned Hillary Clinton and Barack Obama.<a href="#sdfootnote14sym">14</a> Interestingly, despite over 1,000 retweets (many of which were collected by this study), her tweet mentioning both Hillary Clinton and Donald Trump<a href="#sdfootnote15sym">15</a> was not captured by the TAGS software.</p>
<p>https://twitter.com/DrJillStein/status/792071109961285632</p>
<p>Perhaps surprisingly for a major party candidate, the twitter handle of Donald Trump, <span class="citation" data-cites="REALDONALDTRUMP">@REALDONALDTRUMP</span>, is an outlier on this list: he ranks at 112,160 with only 933 total mentions. Trump’s publicized investments and connections with the Dakota Access project<a href="#sdfootnote16sym">16</a> and environmental positions, including discounting climate change,<a href="#sdfootnote17sym">17</a> almost certainly makes him unlikely to be sympathetic, let alone an ally of the # NODAPL movement. Indeed, most of his mentions on the network are simply retweets of Dr.&nbsp;Jill Stein’s criticism against Donald Trump and Hillary Clinton’s lack of involvement in the pipeline issue.<a href="#sdfootnote18sym">18</a></p>
<p>Drilling down further into the data, I next looked at the nodes with the highest out-degree, which represents nodes who mentioned other users and hashtags. There were some interesting variations from the trends of in-degree nodes. Three users, <span class="citation" data-cites="DEANLEH">@DEANLEH</span>, <span class="citation" data-cites="CANATIVEOBT">@CANATIVEOBT</span>, and <span class="citation" data-cites="WMN4SRVL">@WMN4SRVL</span> had in-degree and out-degree measurements that were no more than 20% divergent from each other. However, this does not mean that these nodes are engaged in extensive online conversations. These accounts all feature extensive retweets and linkages to different causes often associated with the progressive movement, including climate change awareness, opposition to institutional racism, feminism, and anti-corporatism. All three of these accounts seem to perform a function similar to news aggregation, as the majority of their mentions are retweets from other sources and are not extensive discussions with other users.</p>
<p>Another useful statistics, <em>betweenness</em>, measures the number of shortest paths (connections between any two nodes on the graph that may involve any number of additional nodes) that pass through a specific node.<a href="#sdfootnote19sym">19</a> Nodes with a high betweenness are “central” in that they play a critical role in connecting (and therefore moving information) through the network. The single node with the highest betweenness is <span class="citation" data-cites="UR">@UR</span>_NINJA, which combined with its high degree ranking, suggests that the news service plays a critical role in bringing together individuals on the graph who are interested in social justice / progressive issues. Four other nodes in the top 25 betweenness list are likewise in the top 25 nodes by degree.</p>
<p>The remaing&nbsp;nodes are somewhat surprising. The twitter profile for second highest betweenness node, <span class="citation" data-cites="TNPMR">@TNPMR</span> has a limited online footprint outside of Twitter, and does not seem to be involved in a leadership capacity in a social movement or media organization. Another important node in this measurement, <span class="citation" data-cites="AMAZONMILLER">@AMAZONMILLER</span>, only scores 1638th in total degrees, yet still retains an important place in the network structure. Looking further at this data, I next examined at each individual user’s Twitter profile who scored in the top 25 for betweenness. I divided this list into people who seem to be primarily interested in progressive causes in general vs.&nbsp;those who expressed affinity for indigenous rights issues. The results were nearly evenly split, with a slight edge to the more general progressivists. However, only two of top ten&nbsp;nodes in the betweenness category focused primarily on indigenous issues, while the rest were concerned with progressivist issues more broadly. What this may indicate is that, as a whole, indigenous activists may face future difficulties in promoting their narrative outside of the more general progressive interests of the online community.</p>
<p><strong>Further</strong> <strong>Observations:</strong></p>
<p>These preliminary steps have also revealed some issues about data collection and curation. Twitter’s REST and streaming APIs are woefully inadequate for examining the whole data set. While Twitter provides, in theory, a representative sample of the data set, one of the powers of social network analysis is the discovery of weak ties and other network structures which are by definition not representative of the network as a whole. This can be frustrating for academic study of the network, and extremely detrimental to movements that depend on social media to transmit their messages. Groups can look at their own twitter histories, but the larger network structure, along with crucial weak ties, may be invisible to them.</p>
<p>Although Twitter does provide mechanisms for obtaining the entire history of hashtag usage, the organic development of other hashtags which are not heavily watched from the beginning is almost certainly a cost-prohibitive proposition for social movements that are loosely organized, under-funded, and / or have limited computer infrastructure. It would be a significant benefit for such groups to gain access to the Twitter history of their movements, and be able to the evolution of the conversation on social media. As hashtag use can grow organically, with many different signifiers used for conversations, Twitter’s current pricing structure and data access model puts these groups at a severe disadvantage and hinders the identification and cultivation of allied communities and supporters.</p>
<p>A less pressing, but nevertheless important, issue is access to Twitter’s archive by researchers. Unlike print material or traditional media, which may be tedious to analyze but are fully (and for the most part cheaply) accessible to interested parties, the complete set of tweets on a topic are impossible to study without significant funding. Even if a researcher could guess all of the hashtags that could emerge from a dynamic topic, the Twitter streaming API does not provide all relevant tweets. Such limitations make it challenging to use Twitter data in a pedagogical setting. Some of my students have expressed interest in conducting similar projects, but the need for constant downstream connections and the high cost of historical tweets have made all but the most superficial studies impossible. There needs to be a more cost-effective means for projects operating on a limited budget, students, and other academic uses of Twitter’s data.</p>
<p><strong>Next Steps:</strong></p>
<p>In addition to the data set on #NoDAPL featured here, I have also compiled a number of hashtags and data in separate TAGS sheets which can be combined to see more of the network. I am currently running a python script to grab more tweet data from the streaming API, which should provide more tweets. After placing this data in the network and performing some basic sentiment analysis, I want to see if distinct communities have formed around different hashtags, and if those communities have noticeably different rhetorical strategies that correspond to the inclusion of certain hashtags. A long term goal is to secure funding to obtain the complete twitter archive of #NODAPL and related hashtags in order to perform a full social network and sentiment analysis. In addition, I would like to examine the twitter history of <span class="citation" data-cites="UR">@UR</span>_Ninja and other alternative news organizations to see if their followers form recognizable activist communities. As part of this analysis, I am especially interested to see how these communities change when news organization shifts their focus between causes (like #FERGUSON to #NODAPL), and to examine the interactions of these virtual communities with different social movements.</p>
<p>To overcome the issues I discovered with TAGS and TwitterStreamingImporter, I am currently running a python script (modeled after <a href="http://adilmoujahid.com/posts/2014/07/twitter-analytics/">http://adilmoujahid.com/posts/2014/07/twitter-analytics/</a>) that pulls in the full json object from Twitter’s streaming API for a number of hashtags related to #NODAPL. I think the best approach is to perform a weekly update of a “master” network that captures all of the data that I can dealing with #NODAPL, and then running statistics / etc from a filtered network in Gephi. I will be sure to post any additional developments here.</p>
<p><strong>Detailed Procedure:</strong></p>
<p>The first difficulty in analyzing Twitter traffic is actually obtaining Twitter data. While Twitter does retain a historical archive of all tweets, this resource is currently inaccessible for academic research unless licensing fees are paid to an archival service such as GNIP. There is an indication that GNIP is aware of the power of Twitter analytics for academic research, and there are different pricing plans available,<a href="#sdfootnote20sym">20</a> but as my project is currently in the exploratory phase, I am operating without any funding. As such, I needed an alternative.</p>
<p>I first used TAGS to pull historical and incoming tweets into separate google sheets for each hashtag I was interested in. TAGS uses Twitter’s REST API, which limits search rates and results.<a href="#sdfootnote21sym">21</a> I ran into rate limits rather quickly with my searches; in addition, my documents in google also hit their size and row limit. TAGS does not provide the entire result from the Twitter API: fields like place, retweeted (which indicates if a tweet was retweeted or not), and other useful fields are left off. Finally, I noticed that the text of tweets was often truncated; this made searching form complete user names, hashtags, and full text problematic. Although TAGS is a convent way to collect tweets, it can not possibly hope to represent the full network.</p>
<p>Despite these imitations, TAGS can still provide some powerful insights with a little modification. After importing my TAGS documents into a postgresql database, I mined the tweet text for all user mentions and hashtags from individual twitter users, which formed the edges of my network. I then imported this into Gephi v.0.9.1<a href="#sdfootnote22sym">22</a>, where I performed some basic network analysis and visualizations of the data.</p>
<p>After this analysis, I decided that I needed to capture more tweets as they are issued. I used the TwitterStreamingImporter plugin for Gephi,<a href="#sdfootnote23sym">23</a> which uses Twitter’s streaming API.<a href="#sdfootnote24sym">24</a> The result is not all tweets that contain specified search terms, but is instead a representative sample that numbers up to 1% of global tweets. At ~ 300 -500 million tweets per day,<a href="#sdfootnote25sym">25</a> the streaming api will return 3 – 5 million tweets on a given subject. For small data sets this may be sufficient, but it is impossible to tell how truly representative this sample is without the complete Twitter firehose.<a href="#sdfootnote26sym">26</a></p>
<p>Unlike TAGS, TwitterStreamingImporter requires a constant internet connection to compile tweets. This is impracticable if not impossible for individuals who use a single laptop or other machine between different locations. I also experienced some crashes while performing analytics and changing/ running the visualization layouts; anyone wishing to style twitter data using this technique may wish to save constantly and export different files for styling purposes. This plugin does a nice job of drawing edges between users, tweets, and hashtags, and specifies the type of edge (tweet, retweet, hashtag, etc), although I would still like some more detailed information. The code is freely accessible,<a href="#sdfootnote27sym">27</a> so I may be able to fork the repository and create a new plugin that pulls in all the data that I am interested in (especially geolocations, time of the tweet, etc). However, I think simply using a python script on a persistent connection will be my next step in this analysis.</p>
<p><strong>Notes:</strong></p>
<p><a href="#sdfootnote1anc">1</a>&nbsp; LLC Dakota Access and United States Army Corps of Engineers, “Environmental Assessment: Dakota Access Pipeline Project, Crossings of Flowage Easements and Federal Lands” (U.S. Army Corps of Engineers, Omaha District, 2016), 8, <a href="http://purl.fdlp.gov/GPO/gpo74064">http://purl.fdlp.gov/GPO/gpo74064</a>.</p>
<p><a href="#sdfootnote2anc">2</a>&nbsp; Further reading can be found at <a href="https://nycstandswithstandingrock.wordpress.com/standingrocksyllabus/">https://nycstandswithstandingrock.wordpress.com/standingrocksyllabus/</a>, created by NYC Stands for Standing Rock committee, a self described group “…group of Indigenous scholars and activists, and settler/ POC supporters.” (<a href="https://nycstandswithstandingrock.wordpress.com/about/">https://nycstandswithstandingrock.wordpress.com/about/</a>).</p>
<p><a href="#sdfootnote3anc">3</a>&nbsp; A. B. C. News, “Court Denies Tribe’s Appeal to Block Dakota Access Pipeline,” <em>ABC News</em>, October 11, 2016, <a href="http://abcnews.go.com/US/court-denies-tribes-appeal-block-controversial-dakota-access/story?id=42700614">http://abcnews.go.com/US/court-denies-tribes-appeal-block-controversial-dakota-access/story?id=42700614</a>.</p>
<p><a href="#sdfootnote4anc">4</a>&nbsp; “Rezpect Our Water,” accessed November 6, 2016, http://rezpectourwater.com/; “Thousands Nationwide Show Solidarity with the Standing Rock Sioux and #NoDAPL,” <em>Sierra Club</em>, September 13, 2016, <a href="http://www.sierraclub.org/planet/2016/09/thousands-nationwide-show-solidarity-standing-rock-sioux-and-nodapl">http://www.sierraclub.org/planet/2016/09/thousands-nationwide-show-solidarity-standing-rock-sioux-and-nodapl</a>.</p>
<p><a href="#sdfootnote5anc">5</a>&nbsp; n.b.&nbsp;Twitter is case insensitive, but all user names and hashtags are capitalized here.</p>
<p><a href="#sdfootnote6anc">6</a>&nbsp;&nbsp;<a href="https://tags.hawksey.info/">https://tags.hawksey.info/</a></p>
<p><a href="#sdfootnote7anc">7</a>&nbsp; I used Gephi with the OpenOrd Layout to create the network visualization1 after modifying TAGS data in a postgresql database. Although the OpenOrd layout is intended for undirected graphs (see <a href="https://marketplace.gephi.org/plugin/openord-layout/">https://marketplace.gephi.org/plugin/openord-layout/</a>), its ability to handle large datasets and limited computing resources made it an attractive choice for this investigation.</p>
<p><a href="#sdfootnote8anc">8</a>&nbsp; The modularity for the graph is 0.414, with 862 communities detected. 32 of these communities had 100 or more nodes, and totaled 131,080 of the 133,702 total, which is 98.04% of the total.</p>
<p><a href="#sdfootnote9anc">9</a>&nbsp;&nbsp;<a href="http://www.unicornriot.ninja/">http://www.unicornriot.ninja/</a></p>
<p><a href="#sdfootnote10anc">10</a>&nbsp; “About,” <em>Unicorn Riot</em>, accessed October 30, 2016, <a href="http://www.unicornriot.ninja/?page_id=372">http://www.unicornriot.ninja/?page_id=372</a>.</p>
<p><a href="#sdfootnote11anc">11</a>&nbsp; The Root Staff, “#NoDAPL: Indigenous Youths Occupy Hillary Clinton’s Brooklyn, NY, Headquarters,” <em>The Root</em>, October 29, 2016, <a href="http://www.theroot.com/articles/news/2016/10/nodapl-indigenous-youth-occupy-hillary-clintons-brooklyn-headquarters/">http://www.theroot.com/articles/news/2016/10/nodapl-indigenous-youth-occupy-hillary-clintons-brooklyn-headquarters/</a>; “Indigenous Youth Occupy Hillary Clinton Campaign Headquarters to Demand She Take Stand on #DAPL,” <em>Democracy Now!</em>, accessed November 4, 2016, <a href="http://www.democracynow.org/2016/10/28/indigenous_youth_occupy_hillary_clinton_campaign">http://www.democracynow.org/2016/10/28/indigenous_youth_occupy_hillary_clinton_campaign</a>.</p>
<p><a href="#sdfootnote12anc">12</a>&nbsp;&nbsp;<a href="https://twitter.com/SenSanders/status/793196920613240840">https://twitter.com/SenSanders/status/793196920613240840</a></p>
<p><a href="#sdfootnote13anc">13</a>&nbsp; See <a href="https://www.facebook.com/MortonCountySD/photos/pcb.317649668587378/317649315254080/?type=3&amp;theater">https://www.facebook.com/MortonCountySD/photos/pcb.317649668587378/317649315254080/?type=3&amp;theater</a> for an image of the warrant</p>
<p><a href="#sdfootnote14anc">14</a>&nbsp;&nbsp;<a href="https://twitter.com/NaomiAKlein/status/791756857958203392">https://twitter.com/NaomiAKlein/status/791756857958203392</a></p>
<p><a href="#sdfootnote15anc">15</a>&nbsp;&nbsp;<a href="https://twitter.com/DrJillStein/status/792071109961285632">https://twitter.com/DrJillStein/status/792071109961285632</a></p>
<p><a href="#sdfootnote16anc">16</a>&nbsp; Oliver Milman, “Dakota Access Pipeline Company and Donald Trump Have Close Financial Ties,” <em>The Guardian</em>, October 26, 2016, sec.&nbsp;US news, <a href="https://www.theguardian.com/us-news/2016/oct/26/donald-trump-dakota-access-pipeline-investment-energy-transfer-partners">https://www.theguardian.com/us-news/2016/oct/26/donald-trump-dakota-access-pipeline-investment-energy-transfer-partners</a>; “The Latest: Trump Holds Dakota Access Pipeline Company Stock,” <em>US News &amp; World Report</em>, accessed November 4, 2016, <a href="http://www.usnews.com/news/us/articles/2016-10-26/the-latest-pipeline-protesters-think-their-removal-imminent">http://www.usnews.com/news/us/articles/2016-10-26/the-latest-pipeline-protesters-think-their-removal-imminent</a>.</p>
<p><a href="#sdfootnote17anc">17</a>&nbsp; “Did Trump Say Climate Change Was a Chinese Hoax?,” _<span class="citation" data-cites="politifact_">@politifact_</span>, accessed November 4, 2016, <a href="http://www.politifact.com/truth-o-meter/statements/2016/jun/03/hillary-clinton/yes-donald-trump-did-call-climate-change-chinese-h/">http://www.politifact.com/truth-o-meter/statements/2016/jun/03/hillary-clinton/yes-donald-trump-did-call-climate-change-chinese-h/</a>.</p>
<p><a href="#sdfootnote18anc">18</a>&nbsp;&nbsp;<a href="https://twitter.com/DrJillStein/status/792071109961285632">https://twitter.com/DrJillStein/status/792071109961285632</a></p>
<p><a href="#sdfootnote19anc">19</a>&nbsp; I performed Eigenvector analysis on the data set, but there was little deviation in the top ranked nodes from ranking by total degree.</p>
<p><a href="#sdfootnote20anc">20</a>&nbsp;&nbsp;<a href="https://gnip.com/academic/">https://gnip.com/academic/</a></p>
<p><a href="#sdfootnote21anc">21</a>&nbsp;&nbsp;<a href="https://dev.twitter.com/rest/public/search">https://dev.twitter.com/rest/public/search</a></p>
<p><a href="#sdfootnote22anc">22</a>&nbsp;&nbsp;<a href="https://gephi.org/">https://gephi.org/</a></p>
<p><a href="#sdfootnote23anc">23</a>&nbsp;&nbsp;<a href="https://gephi.org/plugins/#/plugin/twitter-streaming-importer">https://gephi.org/plugins/#/plugin/twitter-streaming-importer</a></p>
<p><a href="#sdfootnote24anc">24</a>&nbsp;&nbsp;<a href="https://dev.twitter.com/streaming/overview">https://dev.twitter.com/streaming/overview</a></p>
<p><a href="#sdfootnote25anc">25</a>&nbsp; Jim Edwards, “Leaked Twitter API Data Shows the Number of Tweets Is in Serious Decline,” <em>Business Insider</em>, accessed November 2, 2016, <a href="http://www.businessinsider.com/tweets-on-twitter-is-in-serious-decline-2016-2">http://www.businessinsider.com/tweets-on-twitter-is-in-serious-decline-2016-2</a>; “Twitter Usage Statistics - Internet Live Stats,” accessed November 2, 2016, <a href="http://www.internetlivestats.com/twitter-statistics/#sources">http://www.internetlivestats.com/twitter-statistics/#sources</a>.</p>
<p><a href="#sdfootnote26anc">26</a>&nbsp; Research on the representative accuracy of Twitter’s API has been mixed; see Fred Morstatter et al., “Is the Sample Good Enough? Comparing Data from Twitter’s Streaming API with Twitter’s Firehose,” <em>arXiv Preprint arXiv:1306.5204</em>, 2013; Fred Morstatter, Jürgen Pfeffer, and Huan Liu, “When Is It Biased?: Assessing the Representativeness of Twitter’s Streaming API,” in <em>Proceedings of the 23rd International Conference on World Wide Web</em> (New York, NY: ACM, 2014).</p>
<p><a href="#sdfootnote27anc">27</a>&nbsp;&nbsp;<a href="https://github.com/totetmatt/gephi-plugins/tree/twitter">https://github.com/totetmatt/gephi-plugins/tree/twitter</a></p>
<p><strong>Bibliography</strong></p>
<p>“A Pipeline Fight and America’s Dark Past.” <em>The New Yorker</em>, September 6, 2016. <a href="http://www.newyorker.com/news/daily-comment/a-pipeline-fight-and-americas-dark-past">http://www.newyorker.com/news/daily-comment/a-pipeline-fight-and-americas-dark-past</a>.</p>
<p>“About.” <em>NYC Stands with Standing Rock</em>, September 13, 2016. <a href="https://nycstandswithstandingrock.wordpress.com/about/">https://nycstandswithstandingrock.wordpress.com/about/</a>.</p>
<p>“About.” <em>Unicorn Riot</em>. Accessed October 30, 2016. <a href="http://www.unicornriot.ninja/?page_id=372">http://www.unicornriot.ninja/?page_id=372</a>.</p>
<p>“Appeals Court Halts Dakota Access Pipeline Work Pending Hearing.” <em>Indianz</em>. Accessed November 6, 2016. <a href="http://www.indianz.com/News/2016/09/16/appeals-court-halts-dakota-access-pipeli.asp">http://www.indianz.com/News/2016/09/16/appeals-court-halts-dakota-access-pipeli.asp</a>.</p>
<p>CNN, Marlena Baldacci, Emanuella Grinberg and Holly Yan. “Dakota Access Pipeline: Police Remove Protesters.” <em>CNN</em>. Accessed November 6, 2016. <a href="http://www.cnn.com/2016/10/27/us/dakota-access-pipeline-protests/index.html">http://www.cnn.com/2016/10/27/us/dakota-access-pipeline-protests/index.html</a>.</p>
<p>Dakota Access, LLC, and United States Army Corps of Engineers. “Environmental Assessment: Dakota Access Pipeline Project, Crossings of Flowage Easements and Federal Lands.” U.S. Army Corps of Engineers, Omaha District, 2016. <a href="http://purl.fdlp.gov/GPO/gpo74064">http://purl.fdlp.gov/GPO/gpo74064</a>.</p>
<p>“Dakota Access Pipeline.” Accessed November 6, 2016. <a href="http://www.daplpipelinefacts.com/">http://www.daplpipelinefacts.com/</a>.</p>
<p>“Dakota Access Pipeline: Overview.” Accessed November 6, 2016. <a href="http://www.daplpipelinefacts.com/about/overview.html">http://www.daplpipelinefacts.com/about/overview.html</a>.</p>
<p>“Did Trump Say Climate Change Was a Chinese Hoax?” _<span class="citation" data-cites="politifact_">@politifact_</span>. Accessed November 4, 2016. <a href="http://www.politifact.com/truth-o-meter/statements/2016/jun/03/hillary-clinton/yes-donald-trump-did-call-climate-change-chinese-h/">http://www.politifact.com/truth-o-meter/statements/2016/jun/03/hillary-clinton/yes-donald-trump-did-call-climate-change-chinese-h/</a>.</p>
<p>Edwards, Jim. “Leaked Twitter API Data Shows the Number of Tweets Is in Serious Decline.” <em>Business Insider</em>. Accessed November 2, 2016. <a href="http://www.businessinsider.com/tweets-on-twitter-is-in-serious-decline-2016-2">http://www.businessinsider.com/tweets-on-twitter-is-in-serious-decline-2016-2</a>.</p>
<p>Healy, Jack. “From 280 Tribes, a Protest on the Plains.” <em>The New York Times</em>, September 11, 2016. <a href="http://www.nytimes.com/interactive/2016/09/12/us/12tribes.html">http://www.nytimes.com/interactive/2016/09/12/us/12tribes.html</a>.</p>
<p>“Indigenous Youth Occupy Hillary Clinton Campaign Headquarters to Demand She Take Stand on #DAPL.” <em>Democracy Now!</em> Accessed November 4, 2016. <a href="http://www.democracynow.org/2016/10/28/indigenous_youth_occupy_hillary_clinton_campaign">http://www.democracynow.org/2016/10/28/indigenous_youth_occupy_hillary_clinton_campaign</a>.</p>
<p>“Judge Rules That Construction Can Proceed On Dakota Access Pipeline.” <em>NPR.org</em>. Accessed November 6, 2016. <a href="http://www.npr.org/sections/thetwo-way/2016/09/09/493280504/judge-rules-that-construction-can-proceed-on-dakota-access-pipeline">http://www.npr.org/sections/thetwo-way/2016/09/09/493280504/judge-rules-that-construction-can-proceed-on-dakota-access-pipeline</a>.</p>
<p>“Life in the Native American Oil Protest Camps.” <em>BBC News</em>, September 2, 2016, sec.&nbsp;US &amp; Canada. <a href="http://www.bbc.com/news/world-us-canada-37249617">http://www.bbc.com/news/world-us-canada-37249617</a>.</p>
<p>McCausland, Phil. “More Than 80 Dakota Pipeline Protesters Arrested, Some Pepper Sprayed.” <em>NBC News</em>, October 23, 2016. <a href="http://www.nbcnews.com/news/us-news/more-80-dakota-access-pipeline-protesters-arrested-some-pepper-sprayed-n671281">http://www.nbcnews.com/news/us-news/more-80-dakota-access-pipeline-protesters-arrested-some-pepper-sprayed-n671281</a>.</p>
<p>McCleary, Mike. “As Standing Rock Protesters Face Down Armored Trucks, the World Watches on Facebook.” <em>WIRED</em>. Accessed October 30, 2016. <a href="https://www.wired.com/2016/10/standing-rock-protesters-face-police-world-watches-facebook/">https://www.wired.com/2016/10/standing-rock-protesters-face-police-world-watches-facebook/</a>.</p>
<p>Milman, Oliver. “Dakota Access Pipeline Company and Donald Trump Have Close Financial Ties.” <em>The Guardian</em>, October 26, 2016, sec.&nbsp;US news. <a href="https://www.theguardian.com/us-news/2016/oct/26/donald-trump-dakota-access-pipeline-investment-energy-transfer-partners">https://www.theguardian.com/us-news/2016/oct/26/donald-trump-dakota-access-pipeline-investment-energy-transfer-partners</a>.</p>
<p>Morstatter, Fred, Jürgen Pfeffer, and Huan Liu. “When Is It Biased?: Assessing the Representativeness of Twitter’s Streaming API.” In <em>Proceedings of the 23rd International Conference on World Wide Web</em>. New York, NY: ACM, 2014.</p>
<p>Morstatter, Fred, Jürgen Pfeffer, Huan Liu, and Kathleen M Carley. “Is the Sample Good Enough? Comparing Data from Twitter’s Streaming API with Twitter’s Firehose.” <em>arXiv Preprint arXiv:1306.5204</em>, 2013.</p>
<p>News, A. B. C. “Court Denies Tribe’s Appeal to Block Dakota Access Pipeline.” <em>ABC News</em>, October 11, 2016. <a href="http://abcnews.go.com/US/court-denies-tribes-appeal-block-controversial-dakota-access/story?id=42700614">http://abcnews.go.com/US/court-denies-tribes-appeal-block-controversial-dakota-access/story?id=42700614</a>.</p>
<p>———. “Timeline of the Dakota Access Pipeline Protests.” <em>ABC News</em>, October 31, 2016. <a href="http://abcnews.go.com/US/timeline-dakota-access-pipeline-protests/story?id=43131355">http://abcnews.go.com/US/timeline-dakota-access-pipeline-protests/story?id=43131355</a>.</p>
<p>“Rezpect Our Water.” Accessed November 6, 2016. <a href="http://rezpectourwater.com/">http://rezpectourwater.com/</a>.</p>
<p>Staff, The Root. “#NoDAPL: Indigenous Youths Occupy Hillary Clinton’s Brooklyn, NY, Headquarters.” <em>The Root</em>, October 29, 2016. <a href="http://www.theroot.com/articles/news/2016/10/nodapl-indigenous-youth-occupy-hillary-clintons-brooklyn-headquarters/">http://www.theroot.com/articles/news/2016/10/nodapl-indigenous-youth-occupy-hillary-clintons-brooklyn-headquarters/</a>.</p>
<p>“The Digital Transition: How the Presidential Transition Works in the Social Media Age.” <em>Whitehouse.gov</em>, October 31, 2016. <a href="https://www.whitehouse.gov/blog/2016/10/31/digital-transition-how-presidential-transition-works-social-media-age">https://www.whitehouse.gov/blog/2016/10/31/digital-transition-how-presidential-transition-works-social-media-age</a>.</p>
<p>“The Latest: Trump Holds Dakota Access Pipeline Company Stock.” <em>US News &amp; World Report</em>. Accessed November 4, 2016. <a href="http://www.usnews.com/news/us/articles/2016-10-26/the-latest-pipeline-protesters-think-their-removal-imminent">http://www.usnews.com/news/us/articles/2016-10-26/the-latest-pipeline-protesters-think-their-removal-imminent</a>.</p>
<p>“Thousands Nationwide Show Solidarity with the Standing Rock Sioux and #NoDAPL.” <em>Sierra Club</em>, September 13, 2016. <a href="http://www.sierraclub.org/planet/2016/09/thousands-nationwide-show-solidarity-standing-rock-sioux-and-nodapl">http://www.sierraclub.org/planet/2016/09/thousands-nationwide-show-solidarity-standing-rock-sioux-and-nodapl</a>.</p>
<p>“Twitter Usage Statistics - Internet Live Stats.” Accessed November 2, 2016. <a href="http://www.internetlivestats.com/twitter-statistics/#sources">http://www.internetlivestats.com/twitter-statistics/#sources</a>.</p>
<p>Williams, Weston. “Standing Rock Protests Escalate, as Tribe Calls for DOJ to Investigate.” <em>Christian Science Monitor</em>, October 24, 2016. <a href="http://www.csmonitor.com/USA/Justice/2016/1024/Standing-Rock-protests-escalate-as-tribe-calls-for-DOJ-to-investigate">http://www.csmonitor.com/USA/Justice/2016/1024/Standing-Rock-protests-escalate-as-tribe-calls-for-DOJ-to-investigate</a>.</p>



<p><br><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>